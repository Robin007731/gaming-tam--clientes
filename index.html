<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ARENA NEON | ZONA GAMER</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@500;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root { --neon-cyan: #00f2ff; --neon-pink: #ff00ff; --bg-dark: #06080c; }
        
        * { -webkit-tap-highlight-color: transparent; }
        body { 
            background: var(--bg-dark); color: white; font-family: 'Rajdhani', sans-serif;
            background-image: radial-gradient(circle at top right, rgba(0, 242, 255, 0.05), transparent),
                              linear-gradient(to bottom, rgba(6,8,12,0.9), rgba(6,8,12,0.98)), 
                              url('https://images.unsplash.com/photo-1542751371-adc38448a05e?q=80&w=2070');
            background-size: cover; background-attachment: fixed;
        }

        .font-orbitron { font-family: 'Orbitron', sans-serif; }

        /* NAVEGACI√ìN RESPONSIVA */
        .nav-link {
            font-size: 10px; font-weight: 700; text-transform: uppercase; letter-spacing: 1px;
            color: rgba(255,255,255,0.5); transition: 0.3s;
        }
        .nav-link.active { color: var(--neon-cyan); text-shadow: 0 0 10px var(--neon-cyan); }

        /* BOTONES ADAPTATIVOS */
        .btn-arena {
            border: 2px solid var(--neon-pink);
            background: transparent; color: white;
            padding: 12px 24px; font-weight: 800; font-family: 'Orbitron'; font-size: 10px;
            text-transform: uppercase; letter-spacing: 2px;
            clip-path: polygon(10% 0, 100% 0, 90% 100%, 0 100%);
            transition: 0.4s; cursor: pointer; white-space: nowrap;
        }
        .btn-arena:active { transform: scale(0.95); background: var(--neon-pink); }

        /* PANELES */
        .neon-panel {
            background: rgba(13, 17, 23, 0.7); backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-left: 3px solid var(--neon-cyan);
        }

        /* WHATSAPP MOBILE OPTIMIZED */
        .wa-float {
            position: fixed; bottom: 85px; right: 20px;
            background: #25d366; width: 55px; height: 55px;
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            box-shadow: 0 0 20px rgba(37, 211, 102, 0.4); z-index: 50;
        }

        /* HUD CIRCULAR RESPONSIVO */
        .hud-status {
            width: 110px; height: 110px; border-radius: 50%;
            border: 2px solid #22c55e;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            background: rgba(0,0,0,0.7); box-shadow: 0 0 15px rgba(34, 197, 94, 0.2);
        }

        .view-section { display: none; padding-bottom: 100px; }
        .view-section.active { display: block; animation: fadeInUp 0.4s ease-out; }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* AJUSTES PARA M√ìVILES */
        @media (max-width: 768px) {
            .mobile-nav { background: rgba(0,0,0,0.9); backdrop-filter: blur(15px); border-top: 1px solid rgba(255,255,255,0.1); }
            .hero-title { font-size: 3.5rem !important; line-height: 1; }
            .wa-float { bottom: 90px; width: 50px; height: 50px; }
        }
    </style>
</head>
<body class="overflow-x-hidden">

    <a href="https://wa.me/TU_GRUPO" target="_blank" class="wa-float">
        <svg fill="white" width="28" height="28" viewBox="0 0 24 24"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/></svg>
    </a>

    <div id="auth-screen" class="fixed inset-0 z-[100] flex items-center justify-center bg-[#06080c] p-6">
        <div class="neon-panel p-8 rounded-xl w-full max-w-sm text-center border-t-2 border-t-cyan-500">
            <h2 class="font-orbitron text-xl mb-6 tracking-tighter italic">PROTOCOLO_<span class="text-cyan-400">ARENA</span></h2>
            <form id="auth-form" class="space-y-4">
                <input id="u-email" type="email" placeholder="EMAIL@RED.COM" class="w-full bg-white/5 p-4 rounded text-xs border border-white/10 outline-none focus:border-cyan-400 font-bold">
                <input id="u-pass" type="password" placeholder="CONTRASE√ëA" class="w-full bg-white/5 p-4 rounded text-xs border border-white/10 outline-none focus:border-cyan-400 font-bold">
                <button type="submit" class="w-full btn-arena">INICIAR CONEXI√ìN</button>
            </form>
        </div>
    </div>

    <div id="main-app" class="hidden min-h-screen">
        
        <header class="hidden md:flex fixed top-0 w-full z-50 bg-black/60 backdrop-blur-xl border-b border-white/5 px-12 py-4 justify-between items-center">
            <div class="flex items-center gap-3">
                <div class="w-8 h-8 bg-cyan-500 rounded-sm rotate-45 flex items-center justify-center border border-white">
                    <span class="rotate-[-45deg] text-black font-black text-xs">A</span>
                </div>
                <h1 class="font-orbitron text-md font-black tracking-widest">ARENA <span class="text-cyan-400">NEON</span></h1>
            </div>
            <nav class="flex gap-8">
                <button onclick="showView('inicio')" class="nav-link active" id="link-inicio">Inicio</button>
                <button onclick="showView('torneos')" class="nav-link" id="link-torneos">Torneos</button>
                <button onclick="showView('perfil')" class="nav-link" id="link-perfil">Perfil</button>
                <button onclick="showView('ranking')" class="nav-link" id="link-ranking">Ranking</button>
                <button onclick="showView('soporte')" class="nav-link" id="link-soporte">Soporte</button>
            </nav>
        </header>

        <header class="md:hidden fixed bottom-0 w-full z-[60] mobile-nav px-4 py-3 flex justify-around items-center">
            <button onclick="showView('inicio')" class="flex flex-col items-center gap-1 nav-link active" id="mlink-inicio">
                <span class="text-[18px]">üè†</span><span class="text-[8px]">INICIO</span>
            </button>
            <button onclick="showView('torneos')" class="flex flex-col items-center gap-1 nav-link" id="mlink-torneos">
                <span class="text-[18px]">‚öîÔ∏è</span><span class="text-[8px]">TORNEOS</span>
            </button>
            <button onclick="showView('perfil')" class="flex flex-col items-center gap-1 nav-link" id="mlink-perfil">
                <span class="text-[18px]">üë§</span><span class="text-[8px]">PERFIL</span>
            </button>
            <button onclick="showView('ranking')" class="flex flex-col items-center gap-1 nav-link" id="mlink-ranking">
                <span class="text-[18px]">üèÜ</span><span class="text-[8px]">TOP</span>
            </button>
        </header>

        <section id="view-inicio" class="view-section active pt-20 md:pt-0 min-h-screen flex items-center px-6 md:px-24">
            <div class="grid grid-cols-1 lg:grid-cols-2 w-full gap-12 items-center">
                <div class="text-center lg:text-left">
                    <p class="text-cyan-400 font-bold tracking-[0.3em] text-[10px] uppercase mb-4">Elite Gaming Experience</p>
                    <h2 class="hero-title text-5xl md:text-8xl font-black font-orbitron leading-tight italic tracking-tighter mb-8">
                        TU ARENA <br> <span class="text-transparent" style="-webkit-text-stroke: 1px white;">TE ESPERA.</span>
                    </h2>
                    <div class="flex flex-col md:flex-row gap-6 items-center lg:justify-start">
                        <button onclick="showView('torneos')" class="btn-arena w-full md:w-auto">Explorar Torneos</button>
                        <span class="text-[9px] font-bold text-zinc-500 uppercase tracking-widest">Now Playing: E-Sports Global</span>
                    </div>
                </div>
                <div class="flex justify-center lg:justify-end">
                    <div class="hud-status">
                        <p class="text-2xl font-black font-orbitron">147,352</p>
                        <p class="text-[7px] font-bold text-green-500 uppercase tracking-widest">Online Now</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="view-torneos" class="view-section pt-10 md:pt-32 px-6 md:px-12">
            <h3 class="font-orbitron text-2xl md:text-4xl font-black italic mb-8">ARENA_LIVE</h3>
            <div id="grid-torneos" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                </div>
        </section>

        <section id="view-perfil" class="view-section pt-10 md:pt-32 px-6 max-w-4xl mx-auto">
            <div class="neon-panel p-8 rounded-xl text-center mb-6">
                <img id="p-img" class="w-24 h-24 rounded-full mx-auto border-2 border-cyan-400 p-1 mb-4 object-cover">
                <h4 id="p-nombre" class="font-orbitron text-xl font-bold uppercase tracking-tight">Cargando...</h4>
                <p id="p-frase" class="text-zinc-500 text-[10px] italic mt-1 mb-6"></p>
                <div class="grid grid-cols-2 gap-4">
                    <div class="bg-black/40 p-4 rounded border border-white/5">
                        <span class="block text-2xl font-black font-orbitron text-cyan-400" id="p-xp">0</span>
                        <span class="text-[8px] font-bold text-zinc-600 uppercase">Puntos XP</span>
                    </div>
                    <div class="bg-black/40 p-4 rounded border border-white/5">
                        <span class="block text-2xl font-black font-orbitron text-pink-500" id="p-wins">0</span>
                        <span class="text-[8px] font-bold text-zinc-600 uppercase">Victorias</span>
                    </div>
                </div>
                <button onclick="logout()" class="mt-8 text-[9px] font-bold text-red-500 tracking-widest uppercase">Desconectar Terminal</button>
            </div>
        </section>

        <section id="view-ranking" class="view-section pt-10 md:pt-32 px-6 max-w-2xl mx-auto">
            <h3 class="font-orbitron text-2xl mb-8 italic text-center">TOP_PLAYERS</h3>
            <div id="list-ranking" class="space-y-3">
                </div>
        </section>

        <section id="view-soporte" class="view-section pt-10 md:pt-32 px-6 max-w-xl mx-auto">
            <div class="neon-panel p-6 rounded-xl">
                <h3 class="font-orbitron text-lg mb-6 text-cyan-400 italic uppercase">Soporte T√©cnico</h3>
                <div class="space-y-4">
                    <input id="s-asunto" placeholder="TEMA" class="w-full bg-black/40 p-4 border border-white/10 outline-none text-xs font-bold rounded">
                    <textarea id="s-mensaje" rows="4" placeholder="MENSAJE..." class="w-full bg-black/40 p-4 border border-white/10 outline-none text-xs font-bold rounded"></textarea>
                    <button onclick="enviarTicket()" class="w-full btn-arena">Enviar Se√±al</button>
                </div>
            </div>
        </section>

    </div>

    <script>
        const _supa = supabase.createClient('https://qxvqxdsfcvdmanxtzmkn.supabase.co', 'sb_publishable_X2_itSXVSMUgkZeDLSE3KQ_HxD1Jf07');
        let user = null;

        function showView(v) {
            document.querySelectorAll('.view-section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
            
            document.getElementById('view-' + v).classList.add('active');
            
            // Activar link desktop y mobile
            const lD = document.getElementById('link-' + v); if(lD) lD.classList.add('active');
            const lM = document.getElementById('mlink-' + v); if(lM) lM.classList.add('active');

            if(v === 'torneos') cargarTorneos();
            if(v === 'perfil') syncProfile();
            if(v === 'ranking') cargarRanking();
            window.scrollTo(0,0);
        }

        document.getElementById('auth-form').onsubmit = async (e) => {
            e.preventDefault();
            const email = document.getElementById('u-email').value;
            const pass = document.getElementById('u-pass').value;
            const { data, error } = await _supa.auth.signInWithPassword({ email, password: pass });
            if(error) {
                const { error: regErr } = await _supa.auth.signUp({ email, password: pass });
                if(regErr) alert("FALLO DE ACCESO"); else alert("GUERRERO REGISTRADO");
            }
        };

        _supa.auth.onAuthStateChange((ev, session) => {
            if(session) {
                user = session.user;
                document.getElementById('auth-screen').style.display = 'none';
                document.getElementById('main-app').classList.remove('hidden');
                syncProfile();
                initRealtime();
            }
        });

        async function syncProfile() {
            const { data } = await _supa.from('perfiles').select('*').eq('id', user.id).single();
            if(data) {
                document.getElementById('p-nombre').innerText = data.nombre;
                document.getElementById('p-frase').innerText = data.frase_batalla;
                document.getElementById('p-xp').innerText = data.xp.toLocaleString();
                document.getElementById('p-wins').innerText = data.victorias;
                document.getElementById('p-img').src = data.avatar_url;
            }
        }

        async function cargarTorneos() {
            const { data } = await _supa.from('torneos').select('*').order('created_at', { ascending: false });
            document.getElementById('grid-torneos').innerHTML = data.map(t => `
                <div class="neon-panel p-6 rounded-xl relative group">
                    <p class="text-[8px] font-bold text-pink-500 uppercase tracking-widest mb-1">${t.juego}</p>
                    <h4 class="font-orbitron text-lg font-black italic mb-4 leading-tight">${t.nombre}</h4>
                    <div class="flex justify-between items-end mb-2 text-[10px] font-bold text-zinc-500 uppercase">
                        <span>Llenado Arena</span>
                        <span class="text-cyan-400 font-orbitron">${t.inscritos}/${t.capacidad}</span>
                    </div>
                    <div class="h-1 w-full bg-white/5 mb-6 rounded-full overflow-hidden">
                        <div class="h-full bg-cyan-400 shadow-[0_0_8px_#00f2ff]" style="width: ${(t.inscritos/t.capacidad)*100}%"></div>
                    </div>
                    <button onclick="unirse('${t.id}', ${t.inscritos})" class="w-full py-3 bg-white text-black font-black font-orbitron text-[9px] uppercase tracking-widest">Unirse</button>
                </div>
            `).join('');
        }

        async function cargarRanking() {
            const { data } = await _supa.from('perfiles').select('*').order('xp', { ascending: false }).limit(10);
            document.getElementById('list-ranking').innerHTML = data.map((u, i) => `
                <div class="flex items-center justify-between p-4 bg-white/5 border border-white/5 rounded-lg">
                    <div class="flex items-center gap-4">
                        <span class="font-orbitron text-cyan-400 text-sm">#${i+1}</span>
                        <img src="${u.avatar_url}" class="w-8 h-8 rounded-full border border-white/10">
                        <span class="text-xs font-bold uppercase">${u.nombre}</span>
                    </div>
                    <span class="font-orbitron text-xs text-zinc-400">${u.xp.toLocaleString()} XP</span>
                </div>
            `).join('');
        }

        async function unirse(id, count) {
            await _supa.from('torneos').update({ inscritos: count + 1 }).eq('id', id);
            alert("CONECTADO A LA BATALLA");
        }

        async function enviarTicket() {
            const asunto = document.getElementById('s-asunto').value;
            const mensaje = document.getElementById('s-mensaje').value;
            await _supa.from('tickets_soporte').insert({ user_id: user.id, asunto, mensaje });
            alert("TICKET TRANSMITIDO");
            showView('inicio');
        }

        function initRealtime() {
            _supa.channel('any').on('postgres_changes', { event: '*', schema: 'public', table: 'torneos' }, () => cargarTorneos()).subscribe();
        }

        async function logout() { await _supa.auth.signOut(); location.reload(); }
    </script>
</body>
</html>
