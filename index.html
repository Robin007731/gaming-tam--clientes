<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ARENA NEON | ULTIMATE</title>
    
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;500;700&display=swap" rel="stylesheet">
    
    <style>
        :root { --neon: #00f2ff; --dark: #020408; --glass: rgba(10, 12, 18, 0.8); }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { background: var(--dark); color: #fff; font-family: 'Rajdhani', sans-serif; overflow-x: hidden; min-height: 100vh; }

        /* --- FONDO DE PORTADAS (SIN ZOOM, SOLO FADE) --- */
        .video-bg-container {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: -2; overflow: hidden; background: #000;
        }
        .slide {
            position: absolute; width: 100%; height: 100%;
            background-size: cover; background-position: center;
            opacity: 0;
            /* Eliminamos el transform scale para evitar el zoom */
            animation: softFade 36s linear infinite;
        }
        /* Nombres: bg1.jpg a bg6.jpg */
        .slide:nth-child(1) { background-image: url('bg1.jpg'); animation-delay: 0s; }
        .slide:nth-child(2) { background-image: url('bg2.jpg'); animation-delay: 6s; }
        .slide:nth-child(3) { background-image: url('bg3.jpg'); animation-delay: 12s; }
        .slide:nth-child(4) { background-image: url('bg4.jpg'); animation-delay: 18s; }
        .slide:nth-child(5) { background-image: url('bg5.jpg'); animation-delay: 24s; }
        .slide:nth-child(6) { background-image: url('bg6.jpg'); animation-delay: 30s; }

        @keyframes softFade {
            0% { opacity: 0; }
            8% { opacity: 0.5; } /* Opacidad ideal para ver la imagen y el texto */
            16% { opacity: 0.5; }
            24% { opacity: 0; }
            100% { opacity: 0; }
        }

        .overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(to bottom, rgba(2,4,8,0.5), var(--dark));
            z-index: -1;
        }

        /* --- COMPONENTES --- */
        .font-orbitron { font-family: 'Orbitron', sans-serif; }
        .glass { background: var(--glass); backdrop-filter: blur(15px); border: 1px solid rgba(255,255,255,0.05); }
        
        .btn-cyber {
            background: transparent; border: 2px solid var(--neon);
            color: white; font-family: 'Orbitron'; font-weight: 900; font-size: 11px;
            text-transform: uppercase; letter-spacing: 2px;
            clip-path: polygon(10% 0, 100% 0, 90% 100%, 0 100%);
            transition: 0.3s; cursor: pointer; padding: 12px 25px;
        }
        .btn-cyber:hover { background: var(--neon); color: black; box-shadow: 0 0 15px var(--neon); }

        .app-view { display: none; }
        .app-view.active { display: block; animation: fadeIn 0.8s ease; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        #loader { position: fixed; inset: 0; background: #000; z-index: 9999; display: flex; align-items: center; justify-content: center; }
        .avatar-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(60px, 1fr)); gap: 10px; max-height: 180px; overflow-y: auto; }
        .avatar-card { width: 100%; border-radius: 10px; border: 2px solid transparent; opacity: 0.4; cursor: pointer; }
        .avatar-card.selected { border-color: var(--neon); opacity: 1; }
    </style>
</head>
<body>

    <div class="video-bg-container">
        <div class="slide"></div><div class="slide"></div><div class="slide"></div>
        <div class="slide"></div><div class="slide"></div><div class="slide"></div>
    </div>
    <div class="overlay"></div>

    <div id="loader">
        <div class="w-12 h-12 border-4 border-cyan-500 border-t-transparent rounded-full animate-spin"></div>
    </div>

    <div id="auth-screen" class="hidden min-h-screen flex items-center justify-center p-4">
        <div class="glass p-8 rounded-[2rem] w-full max-w-md shadow-2xl">
            <h2 class="font-orbitron text-3xl font-black text-center mb-8 italic text-cyan-400">ARENA NEON</h2>
            <form id="auth-form" class="space-y-4">
                <div id="reg-extra" class="hidden">
                    <div id="avatar-grid-auth" class="avatar-grid mb-4 p-2 bg-black/40 rounded-xl"></div>
                    <input id="reg-name" type="text" placeholder="NOMBRE DE USUARIO" class="w-full bg-black/60 border border-white/10 p-4 rounded-xl text-white font-bold uppercase mb-4">
                </div>
                <input id="auth-email" type="email" placeholder="EMAIL" class="w-full bg-black/60 border border-white/10 p-4 rounded-xl text-white font-bold" required>
                <input id="auth-pass" type="password" placeholder="PASSWORD" class="w-full bg-black/60 border border-white/10 p-4 rounded-xl text-white font-bold" required>
                <button type="submit" id="auth-btn" class="w-full btn-cyber py-4 mt-2">INGRESAR</button>
            </form>
            <button onclick="toggleAuth()" id="auth-toggle" class="w-full text-center mt-6 text-[10px] font-bold text-zinc-500 uppercase">¬øNo tienes cuenta? Registrate</button>
        </div>
    </div>

    <div id="app-container" class="hidden">
        <header class="fixed top-0 w-full z-50 glass p-5 flex justify-between items-center border-b border-white/5">
            <h1 class="font-orbitron text-[10px] font-black tracking-widest text-cyan-400">ARENA_LIVE_V15</h1>
            <button onclick="logout()" class="text-[9px] font-bold text-red-500 uppercase px-3 py-1 border border-red-500/30 rounded">Salir</button>
        </header>

        <main class="pt-32 pb-32 px-6 max-w-5xl mx-auto">
            <section id="view-home" class="app-view active text-center py-20">
                <h2 class="font-orbitron text-6xl font-black italic mb-10 tracking-tighter">BIENVENIDO</h2>
                <div class="glass p-8 rounded-2xl inline-block border-cyan-500/20">
                    <p id="u-name" class="font-orbitron text-3xl text-white">---</p>
                    <p id="u-xp" class="text-xs font-bold text-cyan-500 tracking-widest">PUNTOS XP: 0</p>
                </div>
                <div class="mt-12">
                    <button onclick="nav('torneos')" class="btn-cyber px-16 py-4">VER TORNEOS</button>
                </div>
            </section>

            <section id="view-torneos" class="app-view">
                <h3 class="font-orbitron text-2xl mb-8 uppercase italic border-l-4 border-cyan-500 pl-4">Combates</h3>
                <div id="torneos-list" class="grid grid-cols-1 md:grid-cols-2 gap-6"></div>
            </section>
        </main>

        <nav class="fixed bottom-6 left-1/2 -translate-x-1/2 z-50 glass rounded-2xl flex justify-around p-4 w-[90%] max-w-xs border-white/10">
            <button onclick="nav('home')" class="text-xl">üè†</button>
            <button onclick="nav('torneos')" class="text-xl">‚öîÔ∏è</button>
            <button onclick="nav('perfil')" class="text-xl">üë§</button>
        </nav>
    </div>

    <script>
        const SB_URL = 'https://qxvqxdsfcvdmanxtzmkn.supabase.co';
        const SB_KEY = 'sb_publishable_X2_itSXVSMUgkZeDLSE3KQ_HxD1Jf07';
        const _supa = supabase.createClient(SB_URL, SB_KEY, { auth: { persistSession: true, storage: window.localStorage } });

        let session = null;
        let isLogin = true;
        let selAvatar = "https://api.dicebear.com/7.x/bottts/svg?seed=1";

        window.onload = async () => {
            renderAvatars();
            const { data } = await _supa.auth.getSession();
            if (data.session) { session = data.session; await loadProfile(); } 
            else { showAuth(); }
            setTimeout(() => { document.getElementById('loader').style.display = 'none'; }, 1500);
        };

        function renderAvatars() {
            const grid = document.getElementById('avatar-grid-auth');
            for(let i=1; i<=10; i++) {
                const url = `https://api.dicebear.com/7.x/bottts/svg?seed=${i}`;
                const img = document.createElement('img');
                img.src = url; img.className = 'avatar-card';
                img.onclick = () => {
                    document.querySelectorAll('.avatar-card').forEach(el => el.classList.remove('selected'));
                    img.classList.add('selected'); selAvatar = url;
                };
                grid.appendChild(img);
            }
        }

        async function loadProfile() {
            const { data } = await _supa.from('perfiles').select('*').eq('id', session.user.id).single();
            if (data) {
                document.getElementById('u-name').innerText = data.nombre;
                document.getElementById('u-xp').innerText = `PUNTOS XP: ${data.xp}`;
                document.getElementById('auth-screen').classList.add('hidden');
                document.getElementById('app-container').classList.remove('hidden');
            }
        }

        function toggleAuth() {
            isLogin = !isLogin;
            document.getElementById('reg-extra').classList.toggle('hidden', isLogin);
            document.getElementById('auth-btn').innerText = isLogin ? 'INGRESAR' : 'CREAR CUENTA';
        }

        document.getElementById('auth-form').onsubmit = async (e) => {
            e.preventDefault();
            const email = document.getElementById('auth-email').value;
            const pass = document.getElementById('auth-pass').value;
            if (isLogin) {
                const { error } = await _supa.auth.signInWithPassword({ email, password: pass });
                if (error) alert(error.message); else location.reload();
            } else {
                const name = document.getElementById('reg-name').value;
                const { data, error } = await _supa.auth.signUp({ email, password: pass });
                if (error) return alert(error.message);
                await _supa.from('perfiles').insert({ id: data.user.id, nombre: name.toUpperCase(), avatar_url: selAvatar });
                location.reload();
            }
        };

        function nav(id) {
            document.querySelectorAll('.app-view').forEach(v => v.classList.remove('active'));
            document.getElementById('view-' + id).classList.add('active');
            if(id === 'torneos') loadTorneos();
        }

        async function loadTorneos() {
            const { data: torneos } = await _supa.from('torneos').select('*');
            document.getElementById('torneos-list').innerHTML = torneos.map(t => `
                <div class="glass p-6 rounded-2xl">
                    <h4 class="font-orbitron text-lg text-cyan-400 mb-2">${t.nombre}</h4>
                    <p class="text-[10px] uppercase font-bold text-zinc-500 mb-4">${t.juego} | ${t.inscritos}/${t.capacidad}</p>
                    <button class="btn-cyber w-full py-2 text-[10px]">Inscribirse</button>
                </div>
            `).join('');
        }

        function showAuth() { document.getElementById('auth-screen').classList.remove('hidden'); }
        async function logout() { await _supa.auth.signOut(); location.reload(); }
    </script>
</body>
</html>
