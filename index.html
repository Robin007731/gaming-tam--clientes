<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZONA GAMER | Simple & Fast</title>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <style>
        body { background: #05050a; color: white; font-family: sans-serif; padding: 20px; }
        .card { background: #111; padding: 20px; border-radius: 10px; border: 1px solid #333; max-width: 400px; margin: auto; }
        h1 { color: #00d4ff; text-align: center; }
        input { width: 100%; padding: 10px; margin: 10px 0; border-radius: 5px; border: 1px solid #444; background: #000; color: white; }
        button { width: 100%; padding: 10px; background: #00d4ff; border: none; color: black; font-weight: bold; cursor: pointer; border-radius: 5px; }
        .hidden { display: none; }
        .nav { display: flex; justify-content: space-around; margin-top: 20px; }
        .nav button { width: 30%; background: #222; color: white; font-size: 10px; }
    </style>
</head>
<body>

    <div id="auth-box" class="card">
        <h1>ZONA GAMER</h1>
        <div id="reg-info" class="hidden">
            <input type="text" id="user" placeholder="Nombre de Usuario">
            <input type="tel" id="whatsapp" placeholder="WhatsApp">
        </div>
        <input type="email" id="email" placeholder="Correo">
        <input type="password" id="pass" placeholder="Contraseña">
        
        <button id="btn-main" onclick="auth()">ENTRAR</button>
        <p id="toggle" onclick="cambiar()" style="text-align:center; font-size:12px; margin-top:10px; cursor:pointer; color:#888;">
            ¿No tienes cuenta? Regístrate aquí
        </p>
    </div>

    <div id="app-box" class="card hidden">
        <h1>HOLA, <span id="display-name">...</span></h1>
        <div id="content" style="margin-top:20px;">
            <p>Cargando torneos...</p>
        </div>
        
        <div class="nav">
            <button onclick="ver('inicio')">INICIO</button>
            <button onclick="ver('perfil')">PERFIL</button>
            <button onclick="salir()" style="background: #500;">SALIR</button>
        </div>
    </div>

    <script>
        // TUS DATOS REALES
        const URL = "https://eixlqskscpsatvaxhshj.supabase.co";
        const KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVpeGxxc2tzY3BzYXR2YXhoc2hqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzg0Njc5ODIsImV4cCI6MjA1NDA0Mzk4Mn0.N-vH6V7Hh-u_v-Q-D-X-O-G-W-A-R-K-E-Y";
        const sb = supabase.createClient(URL, KEY);

        let esLogin = true;

        function cambiar() {
            esLogin = !esLogin;
            document.getElementById('reg-info').classList.toggle('hidden');
            document.getElementById('btn-main').innerText = esLogin ? "ENTRAR" : "CREAR CUENTA";
            document.getElementById('toggle').innerText = esLogin ? "¿No tienes cuenta? Regístrate aquí" : "¿Ya tienes cuenta? Inicia sesión";
        }

        async function auth() {
            const email = document.getElementById('email').value;
            const pass = document.getElementById('pass').value;
            
            if (esLogin) {
                const { error } = await sb.auth.signInWithPassword({ email, password: pass });
                if (error) alert(error.message);
            } else {
                const nombre = document.getElementById('user').value;
                const wa = document.getElementById('whatsapp').value;
                const { error } = await sb.auth.signUp({
                    email, password: pass,
                    options: { data: { username: nombre, whatsapp: wa } }
                });
                if (error) alert(error.message); else alert("¡Registro exitoso! Ya puedes entrar.");
            }
            check();
        }

        async function check() {
            const { data: { user } } = await sb.auth.getUser();
            if (user) {
                document.getElementById('auth-box').classList.add('hidden');
                document.getElementById('app-box').classList.remove('hidden');
                document.getElementById('display-name').innerText = user.user_metadata.username || "GAMER";
                ver('inicio');
            }
        }

        async function ver(seccion) {
            const cont = document.getElementById('content');
            if (seccion === 'inicio') {
                const { data } = await sb.from('tournaments').select('*');
                if (data && data.length > 0) {
                    cont.innerHTML = data.map(t => `<div style="border-bottom:1px solid #333; padding:10px;"><b>${t.name}</b><br>Cupos: ${t.capacity}</div>`).join('');
                } else {
                    cont.innerHTML = "<p>No hay torneos creados aún.</p>";
                }
            } else {
                const { data: { user } } = await sb.auth.getUser();
                cont.innerHTML = `<p>WhatsApp: ${user.user_metadata.whatsapp}</p><p>Email: ${user.email}</p>`;
            }
        }

        async function salir() {
            await sb.auth.signOut();
            location.reload();
        }

        check();
    </script>
</body>
</html>
